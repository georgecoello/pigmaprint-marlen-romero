{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/esnext.uint8-array.set-from-base64.js\";\nimport \"core-js/modules/esnext.uint8-array.set-from-hex.js\";\nimport \"core-js/modules/esnext.uint8-array.to-base64.js\";\nimport \"core-js/modules/esnext.uint8-array.to-hex.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport AppHeader from '@/components/Header.vue';\nexport default {\n  name: 'CartView',\n  components: {\n    AppHeader\n  },\n  data() {\n    return {\n      cartItems: [],\n      cartCount: 0,\n      showContactModal: false,\n      showSuccessModal: false,\n      showClearCartModal: false,\n      showClearCartAfterSuccess: false,\n      sendingEmail: false,\n      customerInfo: {\n        name: '',\n        phone: '',\n        email: ''\n      },\n      backendUrl: 'https://pigmaprint-backend.vercel.app'\n    };\n  },\n  computed: {\n    canSubmitOrder() {\n      return this.customerInfo.name.trim() !== '' && this.customerInfo.phone.trim() !== '' && this.cartItems.length > 0 && !this.sendingEmail;\n    },\n    totalItems() {\n      return this.cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n    },\n    totalImages() {\n      return this.cartItems.reduce((total, item) => total + (item.fileCount || 0), 0);\n    },\n    uniqueProductCodes() {\n      const codes = this.cartItems.map(item => item.productCode).filter(Boolean);\n      return [...new Set(codes)];\n    }\n  },\n  mounted() {\n    this.loadCart();\n  },\n  methods: {\n    // Detectar si un archivo es imagen\n    esImagen(mimetype) {\n      return mimetype && mimetype.startsWith('image/');\n    },\n    // Formatear tama√±o de archivo\n    formatFileSize(bytes) {\n      if (!bytes) return 'N/A';\n      if (bytes === 0) return '0 Bytes';\n      const k = 1024;\n      const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n      const i = Math.floor(Math.log(bytes) / Math.log(k));\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n    },\n    loadCart() {\n      const savedCart = localStorage.getItem('pigmaprint_cart');\n      if (savedCart) {\n        try {\n          const cartData = JSON.parse(savedCart);\n          this.cartItems = cartData.map(item => ({\n            ...item,\n            quantity: item.quantity || 1,\n            // Mantener compatibilidad con version anterior\n            fileCount: item.fileCount || (item.files ? item.files.length : 0),\n            files: item.files || (item.fileData ? [item.fileData] : [])\n          }));\n          this.cartCount = this.cartItems.length;\n          console.log('üõí Carrito cargado:', this.cartItems.length, 'productos');\n          console.log('üì∏ Im√°genes en carrito:', this.totalImages);\n          console.log('üè∑Ô∏è C√≥digos √∫nicos:', this.uniqueProductCodes);\n        } catch (error) {\n          console.error('Error loading cart:', error);\n          this.cartItems = [];\n          this.cartCount = 0;\n        }\n      }\n    },\n    // Sistema de c√≥digos de producto\n    getProductCodePrefix(productType) {\n      const prefixes = {\n        camiseta: 'CA',\n        taza: 'TA',\n        termo: 'TE',\n        gorra: 'GO',\n        vaso: 'VA',\n        hoodie: 'HO',\n        otros: 'OT'\n      };\n      return prefixes[productType] || 'PR';\n    },\n    // M√©todos para manejar cantidades\n    increaseQuantity(itemId) {\n      const item = this.cartItems.find(item => item.id === itemId);\n      if (item) {\n        item.quantity = (item.quantity || 1) + 1;\n        this.saveCart();\n      }\n    },\n    decreaseQuantity(itemId) {\n      const item = this.cartItems.find(item => item.id === itemId);\n      if (item && item.quantity > 1) {\n        item.quantity -= 1;\n        this.saveCart();\n      }\n    },\n    validateQuantity(item) {\n      if (!item.quantity || item.quantity < 1) {\n        item.quantity = 1;\n      }\n      if (item.quantity > 100) {\n        item.quantity = 100;\n      }\n      this.saveCart();\n    },\n    getProductIcon(productType) {\n      const icons = {\n        camiseta: 'checkroom',\n        taza: 'coffee',\n        termo: 'water_bottle',\n        gorra: 'sports_baseball',\n        vaso: 'liquor',\n        hoodie: 'account_circle',\n        otros: 'category'\n      };\n      return icons[productType] || 'category';\n    },\n    getProductTypeLabel(productType) {\n      const labels = {\n        camiseta: 'Camiseta',\n        taza: 'Taza',\n        termo: 'Termo',\n        gorra: 'Gorra',\n        vaso: 'Vaso T√©rmico',\n        hoodie: 'Hoodie',\n        otros: 'Otro Producto'\n      };\n      return labels[productType] || 'Producto';\n    },\n    formatDate(dateString) {\n      if (!dateString) return 'Fecha no disponible';\n      try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('es-ES', {\n          day: '2-digit',\n          month: '2-digit',\n          year: 'numeric'\n        });\n      } catch (error) {\n        return 'Fecha inv√°lida';\n      }\n    },\n    removeItem(itemId) {\n      this.cartItems = this.cartItems.filter(item => item.id !== itemId);\n      this.saveCart();\n      this.cartCount = this.cartItems.length;\n    },\n    clearCart() {\n      if (this.cartItems.length === 0) {\n        console.log('El carrito ya est√° vac√≠o');\n        return;\n      }\n      this.showClearCartModal = true;\n    },\n    confirmClearCart() {\n      this.cartItems = [];\n      this.saveCart();\n      this.cartCount = 0;\n      this.showClearCartModal = false;\n    },\n    // NUEVOS M√âTODOS PARA MANEJAR LA MODAL DESPU√âS DEL √âXITO\n    handleSuccessModalClose() {\n      this.showSuccessModal = false;\n      // Mostrar modal para preguntar si quiere vaciar el carrito\n      setTimeout(() => {\n        this.showClearCartAfterSuccess = true;\n      }, 300);\n    },\n    keepCartItems() {\n      // Simplemente cerrar la modal, el carrito se mantiene\n      this.showClearCartAfterSuccess = false;\n      console.log('‚úÖ Carrito mantenido con', this.totalItems, 'productos');\n    },\n    clearCartAfterSuccess() {\n      // Vaciar el carrito despu√©s del √©xito\n      this.cartItems = [];\n      this.saveCart();\n      this.cartCount = 0;\n      this.showClearCartAfterSuccess = false;\n      console.log('üóëÔ∏è Carrito vaciado despu√©s del env√≠o exitoso');\n    },\n    async saveCart() {\n      try {\n        const cartToSave = this.cartItems.map(item => ({\n          id: item.id,\n          productType: item.productType,\n          productName: item.productName,\n          productCode: item.productCode,\n          hasDesign: item.hasDesign,\n          files: item.files,\n          fileCount: item.fileCount,\n          notes: item.notes,\n          date: item.date,\n          quantity: item.quantity || 1\n        }));\n        localStorage.setItem('pigmaprint_cart', JSON.stringify(cartToSave));\n      } catch (error) {\n        console.error('Error saving cart:', error);\n      }\n    },\n    // ENVIAR PEDIDO\n    async sendOrderByEmail() {\n      if (!this.canSubmitOrder) {\n        alert('Por favor completa tu informaci√≥n de contacto');\n        return;\n      }\n      this.sendingEmail = true;\n      try {\n        // Configuraci√≥n del pedido\n        const emailData = {\n          customerName: this.customerInfo.name,\n          customerPhone: this.customerInfo.phone,\n          customerEmail: this.customerInfo.email || 'No proporcionado',\n          orderDetails: this.createOrderDetails(),\n          files: await this.getFilesFromCart()\n        };\n        console.log('üì§ Enviando pedido al backend...', {\n          customer: emailData.customerName,\n          productos: this.totalItems,\n          imagenes: emailData.files.length,\n          codigos: this.uniqueProductCodes.length\n        });\n\n        // Enviar al backend\n        await this.sendToBackend(emailData);\n\n        // Mostrar modal de √©xito\n        this.showSuccessModal = true;\n        this.showContactModal = false;\n\n        // Limpiar informaci√≥n del cliente\n        this.customerInfo = {\n          name: '',\n          phone: '',\n          email: ''\n        };\n      } catch (error) {\n        console.error('‚ùå Error enviando pedido:', error);\n        alert('‚ùå Error al enviar el pedido: ' + error.message);\n      } finally {\n        this.sendingEmail = false;\n      }\n    },\n    // CREAR DETALLES DEL PEDIDO - CON C√ìDIGOS E IM√ÅGENES\n    createOrderDetails() {\n      const currentDate = new Date().toLocaleDateString('es-ES', {\n        weekday: 'long',\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n      let details = `NUEVO PEDIDO - PIGMAPRINT\\n`;\n      details += `Fecha: ${currentDate}\\n\\n`;\n\n      // Informaci√≥n del cliente\n      details += `üë§ INFORMACI√ìN DEL CLIENTE\\n`;\n      details += `‚Ä¢ Nombre: ${this.customerInfo.name}\\n`;\n      details += `‚Ä¢ Tel√©fono: ${this.customerInfo.phone}\\n`;\n      details += `‚Ä¢ Email: ${this.customerInfo.email || 'No proporcionado'}\\n\\n`;\n\n      // Resumen del pedido\n      details += `üì¶ RESUMEN DEL PEDIDO\\n`;\n      details += `‚Ä¢ Total de productos: ${this.totalItems}\\n`;\n      details += `‚Ä¢ Im√°genes adjuntas: ${this.totalImages}\\n`;\n      details += `‚Ä¢ C√≥digos √∫nicos: ${this.uniqueProductCodes.length}\\n`;\n      details += `‚Ä¢ C√≥digos: ${this.uniqueProductCodes.join(', ')}\\n\\n`;\n\n      // Detalles de productos\n      details += `üé® DETALLES DE PRODUCTOS\\n\\n`;\n      this.cartItems.forEach((item, index) => {\n        const quantity = item.quantity || 1;\n        details += `PRODUCTO ${index + 1} - C√ìDIGO: ${item.productCode || 'N/A'}:\\n`;\n        details += `‚Ä¢ Tipo: ${this.getProductTypeLabel(item.productType)}\\n`;\n        details += `‚Ä¢ Nombre: ${item.productName}\\n`;\n        details += `‚Ä¢ Cantidad: ${quantity} ${quantity === 1 ? 'unidad' : 'unidades'}\\n`;\n        details += `‚Ä¢ Dise√±o: ${item.hasDesign ? 'Con dise√±o propio' : 'Necesita asesor√≠a'}\\n`;\n        if (item.hasDesign && item.files && item.files.length > 0) {\n          details += `‚Ä¢ Im√°genes asociadas: ${item.fileCount}\\n`;\n          item.files.forEach((file, fileIndex) => {\n            details += `  - Imagen ${fileIndex + 1}: ${file.name} (${this.formatFileSize(file.size)})\\n`;\n          });\n        }\n        if (item.notes && item.notes.trim() !== '') {\n          details += `‚Ä¢ Notas: ${item.notes}\\n`;\n        }\n        details += `‚Ä¢ Fecha de solicitud: ${this.formatDate(item.date)}\\n\\n`;\n      });\n      details += `---\\n`;\n      details += `Este pedido fue generado autom√°ticamente desde la web de Pigmaprint\\n`;\n      details += `Sistema de c√≥digos: CA=Camiseta, TA=Taza, TE=Termo, GO=Gorra, VA=Vaso, HO=Hoodie, OT=Otros\\n`;\n      return details;\n    },\n    // OBTENER ARCHIVOS DESDE EL CARRITO\n    async getFilesFromCart() {\n      const files = [];\n      for (const item of this.cartItems) {\n        if (item.hasDesign && item.files && item.files.length > 0) {\n          for (const fileData of item.files) {\n            try {\n              const file = await this.base64ToFile(fileData.data, `${item.productCode}_${fileData.name}`,\n              // Incluir c√≥digo en nombre\n              fileData.type);\n              files.push(file);\n              console.log(`‚úÖ Imagen preparada: ${file.name} para producto ${item.productCode}`);\n            } catch (error) {\n              console.error(`‚ùå Error convirtiendo imagen ${fileData?.name}:`, error);\n            }\n          }\n        }\n      }\n      return files;\n    },\n    // CONVERTIR BASE64 A FILE\n    base64ToFile(base64String, filename, mimeType) {\n      return new Promise((resolve, reject) => {\n        try {\n          // Separar el data URL del base64\n          const base64Data = base64String.split(',')[1];\n          if (!base64Data) {\n            reject(new Error('Formato base64 inv√°lido'));\n            return;\n          }\n\n          // Decodificar base64\n          const byteCharacters = atob(base64Data);\n          const byteArrays = [];\n          for (let offset = 0; offset < byteCharacters.length; offset += 1024) {\n            const slice = byteCharacters.slice(offset, offset + 1024);\n            const byteNumbers = new Array(slice.length);\n            for (let i = 0; i < slice.length; i++) {\n              byteNumbers[i] = slice.charCodeAt(i);\n            }\n            const byteArray = new Uint8Array(byteNumbers);\n            byteArrays.push(byteArray);\n          }\n          const blob = new Blob(byteArrays, {\n            type: mimeType\n          });\n          const file = new File([blob], filename, {\n            type: mimeType,\n            lastModified: Date.now()\n          });\n          resolve(file);\n        } catch (error) {\n          reject(error);\n        }\n      });\n    },\n    // ENVIAR AL BACKEND\n    async sendToBackend(emailData) {\n      try {\n        const formData = new FormData();\n\n        // Agregar datos del formulario\n        formData.append('customerName', emailData.customerName);\n        formData.append('customerPhone', emailData.customerPhone);\n        formData.append('customerEmail', emailData.customerEmail);\n        formData.append('orderDetails', emailData.orderDetails);\n\n        // Agregar archivos\n        if (emailData.files && emailData.files.length > 0) {\n          emailData.files.forEach((file, index) => {\n            if (file && file instanceof File) {\n              formData.append('files', file, file.name);\n              console.log(`üì§ Enviando imagen ${index + 1}:`, file.name);\n            }\n          });\n        }\n        console.log(`üì¶ Enviando pedido con ${emailData.files.length} im√°genes...`);\n\n        // Enviar al backend\n        const response = await fetch(`${this.backendUrl}/api/send-order`, {\n          method: 'POST',\n          body: formData\n        });\n        if (!response.ok) {\n          const errorText = await response.text();\n          throw new Error(`Error ${response.status}: ${errorText}`);\n        }\n        const result = await response.json();\n        if (!result.success) {\n          throw new Error(result.message || 'Error en el servidor');\n        }\n        console.log('‚úÖ Respuesta del backend:', result);\n        return result;\n      } catch (error) {\n        console.error('‚ùå Error en comunicaci√≥n con backend:', error);\n        throw new Error('No se pudo conectar con el servidor. Por favor intenta m√°s tarde.');\n      }\n    }\n  }\n};","map":{"version":3,"names":["AppHeader","name","components","data","cartItems","cartCount","showContactModal","showSuccessModal","showClearCartModal","showClearCartAfterSuccess","sendingEmail","customerInfo","phone","email","backendUrl","computed","canSubmitOrder","trim","length","totalItems","reduce","total","item","quantity","totalImages","fileCount","uniqueProductCodes","codes","map","productCode","filter","Boolean","Set","mounted","loadCart","methods","esImagen","mimetype","startsWith","formatFileSize","bytes","k","sizes","i","Math","floor","log","parseFloat","pow","toFixed","savedCart","localStorage","getItem","cartData","JSON","parse","files","fileData","console","error","getProductCodePrefix","productType","prefixes","camiseta","taza","termo","gorra","vaso","hoodie","otros","increaseQuantity","itemId","find","id","saveCart","decreaseQuantity","validateQuantity","getProductIcon","icons","getProductTypeLabel","labels","formatDate","dateString","date","Date","toLocaleDateString","day","month","year","removeItem","clearCart","confirmClearCart","handleSuccessModalClose","setTimeout","keepCartItems","clearCartAfterSuccess","cartToSave","productName","hasDesign","notes","setItem","stringify","sendOrderByEmail","alert","emailData","customerName","customerPhone","customerEmail","orderDetails","createOrderDetails","getFilesFromCart","customer","productos","imagenes","codigos","sendToBackend","message","currentDate","weekday","hour","minute","details","join","forEach","index","file","fileIndex","size","base64ToFile","type","push","base64String","filename","mimeType","Promise","resolve","reject","base64Data","split","Error","byteCharacters","atob","byteArrays","offset","slice","byteNumbers","Array","charCodeAt","byteArray","Uint8Array","blob","Blob","File","lastModified","now","formData","FormData","append","response","fetch","method","body","ok","errorText","text","status","result","json","success"],"sources":["/home/jorge/Escritorio/Jorge-PC/Marlen/pigmaprint-marlen-romero/frontend/src/views/Cart.vue"],"sourcesContent":["<template>\n  <div class=\"flex flex-col min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800\">\n    <AppHeader :cart-count=\"cartCount\" />\n    \n    <main class=\"flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n      <div class=\"max-w-6xl mx-auto\">\n        <!-- Header del Carrito -->\n        <div class=\"text-center mb-12\">\n          <h1 class=\"text-4xl sm:text-5xl font-extrabold tracking-tight bg-gradient-to-r from-purple-600 to-blue-500 bg-clip-text text-transparent\">\n            Tu Carrito\n          </h1>\n          <p class=\"mt-4 text-lg text-gray-600 dark:text-gray-300\">\n            Revisa y gestiona tus productos personalizados\n          </p>\n        </div>\n\n        <!-- Carrito Vac√≠o -->\n        <div v-if=\"cartItems.length === 0\" class=\"text-center bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-12\">\n          <div class=\"text-6xl text-purple-400 mb-6\">\n            <span class=\"material-symbols-outlined\">shopping_cart</span>\n          </div>\n          <h3 class=\"text-2xl font-bold text-gray-800 dark:text-white mb-4\">\n            Tu carrito est√° vac√≠o\n          </h3>\n          <p class=\"text-gray-600 dark:text-gray-300 mb-8 max-w-md mx-auto\">\n            Agrega algunos productos personalizados para comenzar tu pedido.\n          </p>\n          <button \n            @click=\"$router.push('/#carga-diseno')\"\n            class=\"px-8 py-4 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl hover:from-purple-600 hover:to-blue-600 transition-all duration-300 transform hover:-translate-y-0.5\"\n          >\n            <span class=\"material-symbols-outlined align-middle mr-2\">add_circle</span>\n            Agregar Productos\n          </button>\n        </div>\n\n        <!-- Carrito con Productos -->\n        <div v-else class=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <!-- Lista de Productos -->\n          <div class=\"lg:col-span-2 space-y-6\">\n            <!-- Productos -->\n            <div \n              v-for=\"item in cartItems\" \n              :key=\"item.id\"\n              class=\"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 transition-all duration-300 hover:shadow-xl\"\n            >\n              <!-- C√≥digo del Producto -->\n              <div class=\"mb-4 p-3 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-gray-700 dark:to-gray-600 rounded-xl border border-purple-200 dark:border-purple-800\">\n                <div class=\"flex items-center justify-between\">\n                  <div class=\"flex items-center\">\n                    <span class=\"material-symbols-outlined text-purple-600 dark:text-purple-400 mr-2\">qr_code</span>\n                    <span class=\"font-bold text-purple-700 dark:text-purple-300\">C√≥digo: {{ item.productCode }}</span>\n                  </div>\n                  <span class=\"bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-bold\">\n                    {{ getProductCodePrefix(item.productType) }}\n                  </span>\n                </div>\n              </div>\n\n              <div class=\"flex flex-col sm:flex-row gap-6\">\n                <!-- Vista previa - M√∫ltiples im√°genes -->\n                <div class=\"flex-shrink-0\">\n                  <div v-if=\"item.hasDesign && item.files && item.files.length > 0\" class=\"space-y-2\">\n                    <!-- Imagen principal -->\n                    <div class=\"w-32 h-32 bg-gray-100 dark:bg-gray-700 rounded-xl flex items-center justify-center overflow-hidden\">\n                      <img \n                        v-if=\"esImagen(item.files[0].type)\"\n                        :src=\"item.files[0].data\"\n                        :alt=\"item.files[0].name\"\n                        class=\"w-full h-full object-cover\"\n                      />\n                      <span v-else class=\"material-symbols-outlined text-3xl text-blue-600 dark:text-blue-400\">\n                        description\n                      </span>\n                    </div>\n                    <!-- Miniaturas adicionales -->\n                    <div v-if=\"item.files.length > 1\" class=\"flex space-x-1\">\n                      <div \n                        v-for=\"(file, index) in item.files.slice(1, 4)\" \n                        :key=\"index\"\n                        class=\"w-8 h-8 bg-gray-200 dark:bg-gray-600 rounded flex items-center justify-center overflow-hidden\"\n                      >\n                        <img \n                          v-if=\"esImagen(file.type)\"\n                          :src=\"file.data\"\n                          :alt=\"file.name\"\n                          class=\"w-full h-full object-cover\"\n                        />\n                        <span v-else class=\"material-symbols-outlined text-xs text-blue-600 dark:text-blue-400\">\n                          description\n                        </span>\n                      </div>\n                      <div v-if=\"item.files.length > 4\" class=\"w-8 h-8 bg-gray-200 dark:bg-gray-600 rounded flex items-center justify-center\">\n                        <span class=\"text-xs text-gray-600 dark:text-gray-400\">+{{ item.files.length - 4 }}</span>\n                      </div>\n                    </div>\n                  </div>\n                  <div v-else class=\"w-32 h-32 bg-gray-100 dark:bg-gray-700 rounded-xl flex items-center justify-center\">\n                    <span class=\"material-symbols-outlined text-3xl text-purple-600 dark:text-purple-400\">\n                      {{ getProductIcon(item.productType) }}\n                    </span>\n                  </div>\n                </div>\n\n                <!-- Informaci√≥n del Producto -->\n                <div class=\"flex-grow\">\n                  <div class=\"flex flex-col sm:flex-row sm:items-start sm:justify-between mb-4\">\n                    <div class=\"flex-grow\">\n                      <h3 class=\"text-xl font-bold text-gray-800 dark:text-white mb-2\">\n                        {{ item.productName }}\n                      </h3>\n                      \n                      <!-- Estado del dise√±o -->\n                      <div class=\"flex items-center mb-2\">\n                        <span \n                          :class=\"[\n                            'px-2 py-1 rounded-full text-xs font-medium',\n                            item.hasDesign \n                              ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300'\n                              : 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300'\n                          ]\"\n                        >\n                          <span class=\"material-symbols-outlined align-middle text-xs mr-1\">\n                            {{ item.hasDesign ? 'check_circle' : 'help' }}\n                          </span>\n                          {{ item.hasDesign ? 'Con dise√±o propio' : 'Necesita asesor√≠a' }}\n                        </span>\n                      </div>\n\n                      <!-- Informaci√≥n de archivos -->\n                      <div v-if=\"item.hasDesign && item.files && item.files.length > 0\" class=\"mb-2\">\n                        <p class=\"text-gray-600 dark:text-gray-300 text-sm\">\n                          <span class=\"material-symbols-outlined align-middle text-xs mr-1\">image</span>\n                          {{ item.fileCount }} imagen{{ item.fileCount !== 1 ? 'es' : '' }} asociada{{ item.fileCount !== 1 ? 's' : '' }}\n                        </p>\n                        <div class=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                          <span v-for=\"(file, index) in item.files.slice(0, 2)\" :key=\"index\" class=\"mr-2\">\n                            {{ file.name }}\n                            <span v-if=\"file.size\" class=\"text-gray-400\">\n                              ({{ formatFileSize(file.size) }})\n                            </span>\n                          </span>\n                          <span v-if=\"item.files.length > 2\" class=\"text-gray-400\">\n                            +{{ item.files.length - 2 }} m√°s\n                          </span>\n                        </div>\n                      </div>\n                      \n                      <p v-if=\"item.notes\" class=\"text-gray-500 dark:text-gray-400 text-sm mt-2\">\n                        <span class=\"material-symbols-outlined align-middle text-xs mr-1\">notes</span>\n                        Notas: {{ item.notes }}\n                      </p>\n                      \n                      <p class=\"text-gray-600 dark:text-gray-300 text-sm mt-1\">\n                        <span class=\"material-symbols-outlined align-middle text-xs mr-1\">category</span>\n                        Tipo: {{ getProductTypeLabel(item.productType) }}\n                      </p>\n                      \n                      <!-- Selector de Cantidad -->\n                      <div class=\"flex items-center mt-4\">\n                        <label class=\"text-sm font-medium text-gray-700 dark:text-gray-300 mr-3\">\n                          Cantidad:\n                        </label>\n                        <div class=\"flex items-center border border-gray-300 dark:border-gray-600 rounded-lg\">\n                          <button \n                            @click=\"decreaseQuantity(item.id)\"\n                            :disabled=\"item.quantity <= 1\"\n                            class=\"px-3 py-1 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-l-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                          >\n                            <span class=\"material-symbols-outlined text-lg\">remove</span>\n                          </button>\n                          <input \n                            v-model.number=\"item.quantity\"\n                            type=\"number\"\n                            min=\"1\"\n                            max=\"100\"\n                            class=\"w-16 py-1 text-center border-0 bg-transparent text-gray-800 dark:text-white focus:ring-0 focus:outline-none\"\n                            @change=\"validateQuantity(item)\"\n                          >\n                          <button \n                            @click=\"increaseQuantity(item.id)\"\n                            class=\"px-3 py-1 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-r-lg transition-colors\"\n                          >\n                            <span class=\"material-symbols-outlined text-lg\">add</span>\n                          </button>\n                        </div>\n                        <span class=\"ml-2 text-sm text-gray-500 dark:text-gray-400\">\n                          {{ item.quantity }} {{ item.quantity === 1 ? 'unidad' : 'unidades' }}\n                        </span>\n                      </div>\n                    </div>\n                    \n                    <!-- Precio -->\n                    <div class=\"mt-2 sm:mt-0 text-right\">\n                      <p class=\"text-lg font-bold text-purple-600 dark:text-purple-400\">\n                        Por cotizar\n                      </p>\n                      <p class=\"text-sm text-gray-500 dark:text-gray-400\">\n                        {{ formatDate(item.date) }}\n                      </p>\n                    </div>\n                  </div>\n\n                  <!-- Acciones -->\n                  <div class=\"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <button \n                      @click=\"removeItem(item.id)\"\n                      class=\"text-red-500 hover:text-red-700 dark:hover:text-red-400 transition-colors duration-200 flex items-center\"\n                    >\n                      <span class=\"material-symbols-outlined text-lg mr-1\">delete</span>\n                      Eliminar\n                    </button>\n                    \n                    <!-- Informaci√≥n del archivo -->\n                    <div v-if=\"item.hasDesign && item.files && item.files.length > 0\" class=\"text-xs text-gray-500 dark:text-gray-400\">\n                      <span class=\"material-symbols-outlined align-middle text-xs mr-1\">\n                        image\n                      </span>\n                      {{ item.fileCount }} imagen{{ item.fileCount !== 1 ? 'es' : '' }} para {{ item.productCode }}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <!-- Resumen del Pedido -->\n          <div class=\"lg:col-span-1\">\n            <div class=\"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 sticky top-6\">\n              <h3 class=\"text-xl font-bold text-gray-800 dark:text-white mb-6\">\n                Resumen del Pedido\n              </h3>\n\n              <!-- Detalles -->\n              <div class=\"space-y-4 mb-6\">\n                <div class=\"flex justify-between items-center\">\n                  <span class=\"text-gray-600 dark:text-gray-300\">Productos:</span>\n                  <span class=\"font-semibold text-gray-800 dark:text-white\">\n                    {{ totalItems }}\n                  </span>\n                </div>\n\n                <div class=\"flex justify-between items-center\">\n                  <span class=\"text-gray-600 dark:text-gray-300\">Im√°genes:</span>\n                  <span class=\"font-semibold text-gray-800 dark:text-white\">\n                    {{ totalImages }}\n                  </span>\n                </div>\n\n                <div class=\"flex justify-between items-center\">\n                  <span class=\"text-gray-600 dark:text-gray-300\">C√≥digos √∫nicos:</span>\n                  <span class=\"font-semibold text-gray-800 dark:text-white\">\n                    {{ uniqueProductCodes.length }}\n                  </span>\n                </div>\n\n                <div class=\"flex justify-between items-center\">\n                  <span class=\"text-gray-600 dark:text-gray-300\">Estado:</span>\n                  <span class=\"px-3 py-1 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300 rounded-full text-sm font-medium\">\n                    Por cotizar\n                  </span>\n                </div>\n              </div>\n\n              <!-- Total -->\n              <div class=\"border-t border-gray-200 dark:border-gray-700 pt-4 mb-6\">\n                <div class=\"flex justify-between items-center text-lg font-bold\">\n                  <span class=\"text-gray-800 dark:text-white\">Total estimado:</span>\n                  <span class=\"text-purple-600 dark:text-purple-400\">\n                    Por cotizar\n                  </span>\n                </div>\n                <p class=\"text-sm text-gray-500 dark:text-gray-400 mt-2\">\n                  * Los precios finales ser√°n confirmados por nuestro equipo\n                </p>\n              </div>\n\n              <!-- Botones de Acci√≥n -->\n              <div class=\"space-y-4\">\n                <button \n                  @click=\"showContactModal = true\"\n                  :disabled=\"cartItems.length === 0 || sendingEmail\"\n                  :class=\"[\n                    'w-full px-6 py-4 rounded-xl font-semibold shadow-lg transition-all duration-300 transform hover:-translate-y-0.5 flex items-center justify-center',\n                    cartItems.length > 0 && !sendingEmail\n                      ? 'bg-gradient-to-r from-green-500 to-blue-600 text-white hover:shadow-xl hover:from-green-600 hover:to-blue-700'\n                      : 'bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed'\n                  ]\"\n                >\n                  <span class=\"material-symbols-outlined mr-2\" v-if=\"!sendingEmail\">email</span>\n                  <span class=\"material-symbols-outlined mr-2 animate-spin\" v-else>progress_activity</span>\n                  {{ sendingEmail ? 'Enviando...' : 'Enviar Pedido' }}\n                </button>\n                \n                <button \n                  @click=\"$router.push('/')\"\n                  :disabled=\"sendingEmail\"\n                  class=\"w-full px-6 py-4 border-2 border-purple-500 text-purple-600 dark:text-purple-400 dark:border-purple-400 rounded-xl font-semibold hover:bg-purple-50 dark:hover:bg-purple-900/20 transition-all duration-300 flex items-center justify-center\"\n                >\n                  <span class=\"material-symbols-outlined mr-2\">add_circle</span>\n                  Agregar M√°s Productos\n                </button>\n                \n                <button \n                  @click=\"clearCart\"\n                  :disabled=\"sendingEmail || cartItems.length === 0\"\n                  class=\"w-full px-6 py-4 text-red-500 hover:text-red-700 dark:hover:text-red-400 transition-colors duration-200 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  <span class=\"material-symbols-outlined mr-2\">delete_sweep</span>\n                  Vaciar Carrito\n                </button>\n              </div>\n\n              <!-- Informaci√≥n Adicional -->\n              <div class=\"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800\">\n                <div class=\"flex items-start space-x-3\">\n                  <span class=\"material-symbols-outlined text-blue-500 text-lg mt-0.5\">info</span>\n                  <div>\n                    <p class=\"text-sm text-blue-700 dark:text-blue-300 mb-2\">\n                      <strong>Total de productos:</strong> {{ totalItems }}\n                    </p>\n                    <p class=\"text-sm text-blue-700 dark:text-blue-300 mb-2\">\n                      <strong>Im√°genes cargadas:</strong> {{ totalImages }}\n                    </p>\n                    <p class=\"text-sm text-blue-700 dark:text-blue-300 mb-2\">\n                      <strong>C√≥digos √∫nicos:</strong> {{ uniqueProductCodes.length }}\n                    </p>\n                    <p class=\"text-xs text-blue-600 dark:text-blue-400\">\n                      Cada producto tiene un c√≥digo √∫nico para seguimiento.\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </main>\n\n    <!-- Modal de Confirmaci√≥n para Vaciar Carrito -->\n    <transition name=\"modal-fade\">\n      <div \n        v-if=\"showClearCartModal\" \n        class=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-all duration-300\"\n      >\n        <div class=\"relative bg-white dark:bg-gray-800 rounded-3xl shadow-2xl max-w-md w-full mx-auto transform transition-all duration-500 scale-95 hover:scale-100 overflow-hidden border border-gray-200 dark:border-gray-700\">\n          <!-- Header con gradiente -->\n          <div class=\"bg-gradient-to-r from-red-500 to-orange-500 p-6 text-center relative overflow-hidden\">\n            <!-- Efecto de brillo -->\n            <div class=\"absolute inset-0 bg-white/10 backdrop-blur-sm\"></div>\n            \n            <!-- √çcono animado -->\n            <div class=\"relative w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm border border-white/30\">\n              <span class=\"material-symbols-outlined text-2xl text-white animate-pulse\">\n                delete_forever\n              </span>\n            </div>\n            \n            <h3 class=\"text-xl font-bold text-white relative\">\n              Vaciar Carrito\n            </h3>\n          </div>\n\n          <!-- Contenido -->\n          <div class=\"p-8\">\n            <!-- Mensaje principal -->\n            <div class=\"text-center mb-6\">\n              <p class=\"text-lg font-semibold text-gray-800 dark:text-white mb-2\">\n                ¬øEst√°s seguro de que quieres vaciar el carrito?\n              </p>\n              <p class=\"text-gray-600 dark:text-gray-300 text-sm leading-relaxed\">\n                Se eliminar√°n <strong class=\"text-red-500\">{{ totalItems }} productos</strong> y <strong class=\"text-red-500\">{{ totalImages }} im√°genes</strong> de tu carrito actual. \n                Esta acci√≥n no se puede deshacer.\n              </p>\n            </div>\n\n            <!-- Resumen del carrito -->\n            <div class=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4 mb-6\">\n              <div class=\"flex items-center justify-between text-sm mb-2\">\n                <span class=\"text-red-700 dark:text-red-300 font-medium\">\n                  Productos a eliminar:\n                </span>\n                <span class=\"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold\">\n                  {{ totalItems }}\n                </span>\n              </div>\n              <div class=\"flex items-center justify-between text-sm\">\n                <span class=\"text-red-700 dark:text-red-300 font-medium\">\n                  Im√°genes a eliminar:\n                </span>\n                <span class=\"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold\">\n                  {{ totalImages }}\n                </span>\n              </div>\n              <div class=\"flex items-center justify-between text-sm mt-2\">\n                <span class=\"text-red-700 dark:text-red-300 font-medium\">\n                  C√≥digos √∫nicos:\n                </span>\n                <span class=\"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold\">\n                  {{ uniqueProductCodes.length }}\n                </span>\n              </div>\n              <div class=\"mt-2 text-xs text-red-600 dark:text-red-400\">\n                <span class=\"material-symbols-outlined align-middle text-sm mr-1\">info</span>\n                Incluye todos los dise√±os y personalizaciones\n              </div>\n            </div>\n\n            <!-- Botones de acci√≥n -->\n            <div class=\"flex gap-3\">\n              <button \n                @click=\"showClearCartModal = false\"\n                class=\"flex-1 px-6 py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 transform hover:scale-105 flex items-center justify-center group\"\n              >\n                <span class=\"material-symbols-outlined mr-2 text-lg group-hover:animate-pulse\">arrow_back</span>\n                Cancelar\n              </button>\n              \n              <button \n                @click=\"confirmClearCart\"\n                class=\"flex-1 px-6 py-3 bg-gradient-to-r from-red-500 to-orange-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl hover:from-red-600 hover:to-orange-600 transition-all duration-300 transform hover:scale-105 flex items-center justify-center group\"\n              >\n                <span class=\"material-symbols-outlined mr-2 text-lg group-hover:animate-bounce\">delete_sweep</span>\n                Vaciar Todo\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </transition>\n\n    <!-- Modal de Informaci√≥n del Cliente -->\n    <transition name=\"modal-fade\">\n      <div \n        v-if=\"showContactModal\" \n        class=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-all duration-300\"\n        @click.self=\"showContactModal = false\"\n      >\n        <div class=\"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-sm w-full mx-auto transform transition-all duration-500 scale-95 hover:scale-100\">\n          <!-- Header -->\n          <div class=\"bg-gradient-to-r from-green-500 to-blue-600 rounded-t-2xl p-6 text-center\">\n            <div class=\"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-3 backdrop-blur-sm\">\n              <span class=\"material-symbols-outlined text-3xl text-white\">\n                person\n              </span>\n            </div>\n            <h3 class=\"text-xl font-bold text-white mb-1\">\n              Informaci√≥n del Cliente\n            </h3>\n          </div>\n\n          <!-- Formulario -->\n          <div class=\"p-5\">\n            <div class=\"space-y-3\">\n              <div>\n                <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Nombre Completo *\n                </label>\n                <input \n                  v-model=\"customerInfo.name\"\n                  type=\"text\"\n                  :disabled=\"sendingEmail\"\n                  class=\"w-full rounded-lg p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\n                  placeholder=\"Ej: Mar√≠a Gonz√°lez\"\n                  required\n                >\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  N√∫mero de Tel√©fono *\n                </label>\n                <input \n                  v-model=\"customerInfo.phone\"\n                  type=\"tel\"\n                  :disabled=\"sendingEmail\"\n                  class=\"w-full rounded-lg p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\n                  placeholder=\"Ej: 9999-9999\"\n                  required\n                >\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Correo Electr√≥nico (opcional)\n                </label>\n                <input \n                  v-model=\"customerInfo.email\"\n                  type=\"email\"\n                  :disabled=\"sendingEmail\"\n                  class=\"w-full rounded-lg p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\n                  placeholder=\"Ej: cliente@email.com\"\n                >\n              </div>\n            </div>\n\n            <!-- Resumen r√°pido -->\n            <div class=\"mt-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg\">\n              <p class=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                Resumen de tu pedido:\n              </p>\n              <p class=\"text-xs text-gray-600 dark:text-gray-400\">\n                {{ totalItems }} productos ‚Ä¢ {{ totalImages }} im√°genes ‚Ä¢ {{ uniqueProductCodes.length }} c√≥digos √∫nicos\n              </p>\n              <div v-if=\"uniqueProductCodes.length > 0\" class=\"mt-2\">\n                <p class=\"text-xs text-gray-500 dark:text-gray-400\">\n                  C√≥digos: {{ uniqueProductCodes.join(', ') }}\n                </p>\n              </div>\n            </div>\n\n            <!-- Botones -->\n            <div class=\"flex gap-2 mt-4\">\n              <button \n                @click=\"showContactModal = false\"\n                :disabled=\"sendingEmail\"\n                class=\"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Cancelar\n              </button>\n              \n              <button \n                @click=\"sendOrderByEmail\"\n                :disabled=\"!canSubmitOrder\"\n                :class=\"[\n                  'flex-1 px-3 py-2 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-0.5 flex items-center justify-center text-sm',\n                  canSubmitOrder && !sendingEmail\n                    ? 'bg-gradient-to-r from-green-500 to-blue-600 text-white shadow-lg hover:shadow-xl'\n                    : 'bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed'\n                ]\"\n              >\n                <span class=\"material-symbols-outlined mr-1 text-base\" v-if=\"!sendingEmail\">send</span>\n                <span class=\"material-symbols-outlined mr-1 text-base animate-spin\" v-else>progress_activity</span>\n                {{ sendingEmail ? 'Enviando...' : 'Enviar Pedido' }}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </transition>\n\n    <!-- Modal de √âxito -->\n    <transition name=\"modal-fade\">\n      <div \n        v-if=\"showSuccessModal\" \n        class=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-all duration-300\"\n      >\n        <div class=\"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-auto transform transition-all duration-500 scale-95 hover:scale-100 overflow-hidden\">\n          <!-- Fondo decorativo -->\n          <div class=\"absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-green-400 to-blue-500\"></div>\n          \n          <!-- Contenido -->\n          <div class=\"p-8 text-center\">\n            <!-- √çcono animado -->\n            <div class=\"w-20 h-20 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg transform transition-all duration-500 hover:scale-110\">\n              <span class=\"material-symbols-outlined text-3xl text-white\">\n                check\n              </span>\n            </div>\n            \n            <!-- T√≠tulo -->\n            <h3 class=\"text-2xl font-bold text-gray-800 dark:text-white mb-3\">\n              ¬°Pedido Enviado con √âxito!\n            </h3>\n            \n            <!-- Mensaje -->\n            <p class=\"text-gray-600 dark:text-gray-300 mb-6 leading-relaxed\">\n              Tu pedido de <strong>{{ totalItems }} productos</strong> y <strong>{{ totalImages }} im√°genes</strong> ha sido enviado correctamente a nuestro equipo. \n              <span class=\"block mt-2 text-green-600 dark:text-green-400 font-semibold\">\n                Te contactaremos pronto para confirmar los detalles y el precio.\n              </span>\n            </p>\n\n            <!-- Detalles adicionales -->\n            <div class=\"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 mb-6\">\n              <div class=\"flex justify-between items-center text-sm mb-2\">\n                <span class=\"text-gray-500 dark:text-gray-400\">Productos totales:</span>\n                <span class=\"font-semibold text-gray-700 dark:text-gray-300\">{{ totalItems }}</span>\n              </div>\n              <div class=\"flex justify-between items-center text-sm mb-2\">\n                <span class=\"text-gray-500 dark:text-gray-400\">Im√°genes enviadas:</span>\n                <span class=\"font-semibold text-gray-700 dark:text-gray-300\">{{ totalImages }}</span>\n              </div>\n              <div class=\"flex justify-between items-center text-sm\">\n                <span class=\"text-gray-500 dark:text-gray-400\">C√≥digos √∫nicos:</span>\n                <span class=\"font-semibold text-gray-700 dark:text-gray-300\">{{ uniqueProductCodes.length }}</span>\n              </div>\n            </div>\n\n            <!-- Bot√≥n de cierre -->\n            <button \n              @click=\"handleSuccessModalClose\"\n              class=\"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-blue-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl hover:from-green-600 hover:to-blue-700 transition-all duration-300 transform hover:-translate-y-0.5 flex items-center justify-center\"\n            >\n              <span class=\"material-symbols-outlined mr-2\">done_all</span>\n              Entendido\n            </button>\n          </div>\n        </div>\n      </div>\n    </transition>\n\n    <!-- Modal de Confirmaci√≥n para Vaciar Carrito despu√©s del Env√≠o -->\n    <transition name=\"modal-fade\">\n      <div \n        v-if=\"showClearCartAfterSuccess\" \n        class=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-all duration-300\"\n      >\n        <div class=\"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-auto transform transition-all duration-500 scale-95 hover:scale-100 overflow-hidden\">\n          <!-- Fondo decorativo -->\n          <div class=\"absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-purple-500 to-blue-500\"></div>\n          \n          <!-- Contenido -->\n          <div class=\"p-8 text-center\">\n            <!-- √çcono animado -->\n            <div class=\"w-20 h-20 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg transform transition-all duration-500 hover:scale-110\">\n              <span class=\"material-symbols-outlined text-3xl text-white\">\n                shopping_cart_checkout\n              </span>\n            </div>\n            \n            <!-- T√≠tulo -->\n            <h3 class=\"text-2xl font-bold text-gray-800 dark:text-white mb-3\">\n              ¬øVaciar Carrito?\n            </h3>\n            \n            <!-- Mensaje -->\n            <p class=\"text-gray-600 dark:text-gray-300 mb-6 leading-relaxed\">\n              Tu pedido ha sido enviado exitosamente. \n              <span class=\"block mt-2 font-semibold\">\n                ¬øDeseas vaciar el carrito o mantener los productos para un pr√≥ximo pedido?\n              </span>\n            </p>\n\n            <!-- Resumen del carrito -->\n            <div class=\"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4 mb-6\">\n              <div class=\"flex justify-between items-center text-sm mb-2\">\n                <span class=\"text-purple-700 dark:text-purple-300 font-medium\">\n                  Productos en carrito:\n                </span>\n                <span class=\"bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-bold\">\n                  {{ totalItems }}\n                </span>\n              </div>\n              <div class=\"flex justify-between items-center text-sm\">\n                <span class=\"text-purple-700 dark:text-purple-300 font-medium\">\n                  Im√°genes en carrito:\n                </span>\n                <span class=\"bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-bold\">\n                  {{ totalImages }}\n                </span>\n              </div>\n            </div>\n\n            <!-- Botones de acci√≥n -->\n            <div class=\"flex gap-3\">\n              <button \n                @click=\"keepCartItems\"\n                class=\"flex-1 px-6 py-3 border-2 border-purple-500 text-purple-600 dark:text-purple-400 rounded-xl font-semibold hover:bg-purple-50 dark:hover:bg-purple-900/20 transition-all duration-300 transform hover:scale-105 flex items-center justify-center group\"\n              >\n                <span class=\"material-symbols-outlined mr-2 text-lg group-hover:animate-pulse\">inventory_2</span>\n                Mantener\n              </button>\n              \n              <button \n                @click=\"clearCartAfterSuccess\"\n                class=\"flex-1 px-6 py-3 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl hover:from-purple-600 hover:to-blue-600 transition-all duration-300 transform hover:scale-105 flex items-center justify-center group\"\n              >\n                <span class=\"material-symbols-outlined mr-2 text-lg group-hover:animate-bounce\">delete_sweep</span>\n                Vaciar\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </transition>\n  </div>\n</template>\n\n<script>\nimport AppHeader from '@/components/Header.vue'\n\nexport default {\n  name: 'CartView',\n  components: {\n    AppHeader\n  },\n  data() {\n    return {\n      cartItems: [],\n      cartCount: 0,\n      showContactModal: false,\n      showSuccessModal: false,\n      showClearCartModal: false,\n      showClearCartAfterSuccess: false,\n      sendingEmail: false,\n      customerInfo: {\n        name: '',\n        phone: '',\n        email: ''\n      },\n      backendUrl: 'https://pigmaprint-backend.vercel.app'\n    }\n  },\n  computed: {\n    canSubmitOrder() {\n      return this.customerInfo.name.trim() !== '' && \n             this.customerInfo.phone.trim() !== '' &&\n             this.cartItems.length > 0 &&\n             !this.sendingEmail\n    },\n    totalItems() {\n      return this.cartItems.reduce((total, item) => total + (item.quantity || 1), 0)\n    },\n    totalImages() {\n      return this.cartItems.reduce((total, item) => total + (item.fileCount || 0), 0)\n    },\n    uniqueProductCodes() {\n      const codes = this.cartItems.map(item => item.productCode).filter(Boolean);\n      return [...new Set(codes)];\n    }\n  },\n  mounted() {\n    this.loadCart()\n  },\n  methods: {\n    // Detectar si un archivo es imagen\n    esImagen(mimetype) {\n      return mimetype && mimetype.startsWith('image/')\n    },\n\n    // Formatear tama√±o de archivo\n    formatFileSize(bytes) {\n      if (!bytes) return 'N/A'\n      if (bytes === 0) return '0 Bytes'\n      const k = 1024\n      const sizes = ['Bytes', 'KB', 'MB', 'GB']\n      const i = Math.floor(Math.log(bytes) / Math.log(k))\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n    },\n\n    loadCart() {\n      const savedCart = localStorage.getItem('pigmaprint_cart')\n      if (savedCart) {\n        try {\n          const cartData = JSON.parse(savedCart)\n          this.cartItems = cartData.map(item => ({\n            ...item,\n            quantity: item.quantity || 1,\n            // Mantener compatibilidad con version anterior\n            fileCount: item.fileCount || (item.files ? item.files.length : 0),\n            files: item.files || (item.fileData ? [item.fileData] : [])\n          }))\n          this.cartCount = this.cartItems.length\n          console.log('üõí Carrito cargado:', this.cartItems.length, 'productos')\n          console.log('üì∏ Im√°genes en carrito:', this.totalImages)\n          console.log('üè∑Ô∏è C√≥digos √∫nicos:', this.uniqueProductCodes)\n        } catch (error) {\n          console.error('Error loading cart:', error)\n          this.cartItems = []\n          this.cartCount = 0\n        }\n      }\n    },\n\n    // Sistema de c√≥digos de producto\n    getProductCodePrefix(productType) {\n      const prefixes = {\n        camiseta: 'CA',\n        taza: 'TA',\n        termo: 'TE',\n        gorra: 'GO',\n        vaso: 'VA',\n        hoodie: 'HO',\n        otros: 'OT'\n      };\n      return prefixes[productType] || 'PR';\n    },\n\n    // M√©todos para manejar cantidades\n    increaseQuantity(itemId) {\n      const item = this.cartItems.find(item => item.id === itemId)\n      if (item) {\n        item.quantity = (item.quantity || 1) + 1\n        this.saveCart()\n      }\n    },\n\n    decreaseQuantity(itemId) {\n      const item = this.cartItems.find(item => item.id === itemId)\n      if (item && item.quantity > 1) {\n        item.quantity -= 1\n        this.saveCart()\n      }\n    },\n\n    validateQuantity(item) {\n      if (!item.quantity || item.quantity < 1) {\n        item.quantity = 1\n      }\n      if (item.quantity > 100) {\n        item.quantity = 100\n      }\n      this.saveCart()\n    },\n\n    getProductIcon(productType) {\n      const icons = {\n        camiseta: 'checkroom',\n        taza: 'coffee',\n        termo: 'water_bottle',\n        gorra: 'sports_baseball',\n        vaso: 'liquor',\n        hoodie: 'account_circle',\n        otros: 'category'\n      }\n      return icons[productType] || 'category'\n    },\n\n    getProductTypeLabel(productType) {\n      const labels = {\n        camiseta: 'Camiseta',\n        taza: 'Taza',\n        termo: 'Termo',\n        gorra: 'Gorra',\n        vaso: 'Vaso T√©rmico',\n        hoodie: 'Hoodie',\n        otros: 'Otro Producto'\n      }\n      return labels[productType] || 'Producto'\n    },\n    \n    formatDate(dateString) {\n      if (!dateString) return 'Fecha no disponible'\n      try {\n        const date = new Date(dateString)\n        return date.toLocaleDateString('es-ES', {\n          day: '2-digit',\n          month: '2-digit',\n          year: 'numeric'\n        })\n      } catch (error) {\n        return 'Fecha inv√°lida'\n      }\n    },\n    \n    removeItem(itemId) {\n      this.cartItems = this.cartItems.filter(item => item.id !== itemId)\n      this.saveCart()\n      this.cartCount = this.cartItems.length\n    },\n    \n    clearCart() {\n      if (this.cartItems.length === 0) {\n        console.log('El carrito ya est√° vac√≠o')\n        return\n      }\n      this.showClearCartModal = true\n    },\n\n    confirmClearCart() {\n      this.cartItems = []\n      this.saveCart()\n      this.cartCount = 0\n      this.showClearCartModal = false\n    },\n\n    // NUEVOS M√âTODOS PARA MANEJAR LA MODAL DESPU√âS DEL √âXITO\n    handleSuccessModalClose() {\n      this.showSuccessModal = false\n      // Mostrar modal para preguntar si quiere vaciar el carrito\n      setTimeout(() => {\n        this.showClearCartAfterSuccess = true\n      }, 300)\n    },\n\n    keepCartItems() {\n      // Simplemente cerrar la modal, el carrito se mantiene\n      this.showClearCartAfterSuccess = false\n      console.log('‚úÖ Carrito mantenido con', this.totalItems, 'productos')\n    },\n\n    clearCartAfterSuccess() {\n      // Vaciar el carrito despu√©s del √©xito\n      this.cartItems = []\n      this.saveCart()\n      this.cartCount = 0\n      this.showClearCartAfterSuccess = false\n      console.log('üóëÔ∏è Carrito vaciado despu√©s del env√≠o exitoso')\n    },\n    \n    async saveCart() {\n      try {\n        const cartToSave = this.cartItems.map(item => ({\n          id: item.id,\n          productType: item.productType,\n          productName: item.productName,\n          productCode: item.productCode,\n          hasDesign: item.hasDesign,\n          files: item.files,\n          fileCount: item.fileCount,\n          notes: item.notes,\n          date: item.date,\n          quantity: item.quantity || 1\n        }))\n        localStorage.setItem('pigmaprint_cart', JSON.stringify(cartToSave))\n      } catch (error) {\n        console.error('Error saving cart:', error)\n      }\n    },\n\n    // ENVIAR PEDIDO\n    async sendOrderByEmail() {\n      if (!this.canSubmitOrder) {\n        alert('Por favor completa tu informaci√≥n de contacto')\n        return\n      }\n\n      this.sendingEmail = true\n\n      try {\n        // Configuraci√≥n del pedido\n        const emailData = {\n          customerName: this.customerInfo.name,\n          customerPhone: this.customerInfo.phone,\n          customerEmail: this.customerInfo.email || 'No proporcionado',\n          orderDetails: this.createOrderDetails(),\n          files: await this.getFilesFromCart()\n        }\n\n        console.log('üì§ Enviando pedido al backend...', {\n          customer: emailData.customerName,\n          productos: this.totalItems,\n          imagenes: emailData.files.length,\n          codigos: this.uniqueProductCodes.length\n        })\n\n        // Enviar al backend\n        await this.sendToBackend(emailData)\n        \n        // Mostrar modal de √©xito\n        this.showSuccessModal = true\n        this.showContactModal = false\n        \n        // Limpiar informaci√≥n del cliente\n        this.customerInfo = {\n          name: '',\n          phone: '',\n          email: ''\n        }\n        \n      } catch (error) {\n        console.error('‚ùå Error enviando pedido:', error)\n        alert('‚ùå Error al enviar el pedido: ' + error.message)\n      } finally {\n        this.sendingEmail = false\n      }\n    },\n\n    // CREAR DETALLES DEL PEDIDO - CON C√ìDIGOS E IM√ÅGENES\n    createOrderDetails() {\n      const currentDate = new Date().toLocaleDateString('es-ES', {\n        weekday: 'long',\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      })\n\n      let details = `NUEVO PEDIDO - PIGMAPRINT\\n`\n      details += `Fecha: ${currentDate}\\n\\n`\n\n      // Informaci√≥n del cliente\n      details += `üë§ INFORMACI√ìN DEL CLIENTE\\n`\n      details += `‚Ä¢ Nombre: ${this.customerInfo.name}\\n`\n      details += `‚Ä¢ Tel√©fono: ${this.customerInfo.phone}\\n`\n      details += `‚Ä¢ Email: ${this.customerInfo.email || 'No proporcionado'}\\n\\n`\n\n      // Resumen del pedido\n      details += `üì¶ RESUMEN DEL PEDIDO\\n`\n      details += `‚Ä¢ Total de productos: ${this.totalItems}\\n`\n      details += `‚Ä¢ Im√°genes adjuntas: ${this.totalImages}\\n`\n      details += `‚Ä¢ C√≥digos √∫nicos: ${this.uniqueProductCodes.length}\\n`\n      details += `‚Ä¢ C√≥digos: ${this.uniqueProductCodes.join(', ')}\\n\\n`\n\n      // Detalles de productos\n      details += `üé® DETALLES DE PRODUCTOS\\n\\n`\n      \n      this.cartItems.forEach((item, index) => {\n        const quantity = item.quantity || 1\n        details += `PRODUCTO ${index + 1} - C√ìDIGO: ${item.productCode || 'N/A'}:\\n`\n        details += `‚Ä¢ Tipo: ${this.getProductTypeLabel(item.productType)}\\n`\n        details += `‚Ä¢ Nombre: ${item.productName}\\n`\n        details += `‚Ä¢ Cantidad: ${quantity} ${quantity === 1 ? 'unidad' : 'unidades'}\\n`\n        details += `‚Ä¢ Dise√±o: ${item.hasDesign ? 'Con dise√±o propio' : 'Necesita asesor√≠a'}\\n`\n        \n        if (item.hasDesign && item.files && item.files.length > 0) {\n          details += `‚Ä¢ Im√°genes asociadas: ${item.fileCount}\\n`\n          item.files.forEach((file, fileIndex) => {\n            details += `  - Imagen ${fileIndex + 1}: ${file.name} (${this.formatFileSize(file.size)})\\n`\n          })\n        }\n        \n        if (item.notes && item.notes.trim() !== '') {\n          details += `‚Ä¢ Notas: ${item.notes}\\n`\n        }\n        \n        details += `‚Ä¢ Fecha de solicitud: ${this.formatDate(item.date)}\\n\\n`\n      })\n\n      details += `---\\n`\n      details += `Este pedido fue generado autom√°ticamente desde la web de Pigmaprint\\n`\n      details += `Sistema de c√≥digos: CA=Camiseta, TA=Taza, TE=Termo, GO=Gorra, VA=Vaso, HO=Hoodie, OT=Otros\\n`\n\n      return details\n    },\n\n    // OBTENER ARCHIVOS DESDE EL CARRITO\n    async getFilesFromCart() {\n      const files = []\n      \n      for (const item of this.cartItems) {\n        if (item.hasDesign && item.files && item.files.length > 0) {\n          for (const fileData of item.files) {\n            try {\n              const file = await this.base64ToFile(\n                fileData.data,\n                `${item.productCode}_${fileData.name}`, // Incluir c√≥digo en nombre\n                fileData.type\n              )\n              files.push(file)\n              console.log(`‚úÖ Imagen preparada: ${file.name} para producto ${item.productCode}`)\n            } catch (error) {\n              console.error(`‚ùå Error convirtiendo imagen ${fileData?.name}:`, error)\n            }\n          }\n        }\n      }\n      \n      return files\n    },\n\n    // CONVERTIR BASE64 A FILE\n    base64ToFile(base64String, filename, mimeType) {\n      return new Promise((resolve, reject) => {\n        try {\n          // Separar el data URL del base64\n          const base64Data = base64String.split(',')[1]\n          \n          if (!base64Data) {\n            reject(new Error('Formato base64 inv√°lido'))\n            return\n          }\n\n          // Decodificar base64\n          const byteCharacters = atob(base64Data)\n          const byteArrays = []\n\n          for (let offset = 0; offset < byteCharacters.length; offset += 1024) {\n            const slice = byteCharacters.slice(offset, offset + 1024)\n            const byteNumbers = new Array(slice.length)\n            \n            for (let i = 0; i < slice.length; i++) {\n              byteNumbers[i] = slice.charCodeAt(i)\n            }\n            \n            const byteArray = new Uint8Array(byteNumbers)\n            byteArrays.push(byteArray)\n          }\n\n          const blob = new Blob(byteArrays, { type: mimeType })\n          const file = new File([blob], filename, { type: mimeType, lastModified: Date.now() })\n          \n          resolve(file)\n        } catch (error) {\n          reject(error)\n        }\n      })\n    },\n\n    // ENVIAR AL BACKEND\n    async sendToBackend(emailData) {\n      try {\n        const formData = new FormData()\n        \n        // Agregar datos del formulario\n        formData.append('customerName', emailData.customerName)\n        formData.append('customerPhone', emailData.customerPhone)\n        formData.append('customerEmail', emailData.customerEmail)\n        formData.append('orderDetails', emailData.orderDetails)\n        \n        // Agregar archivos\n        if (emailData.files && emailData.files.length > 0) {\n          emailData.files.forEach((file, index) => {\n            if (file && file instanceof File) {\n              formData.append('files', file, file.name)\n              console.log(`üì§ Enviando imagen ${index + 1}:`, file.name)\n            }\n          })\n        }\n\n        console.log(`üì¶ Enviando pedido con ${emailData.files.length} im√°genes...`)\n\n        // Enviar al backend\n        const response = await fetch(`${this.backendUrl}/api/send-order`, {\n          method: 'POST',\n          body: formData\n        })\n\n        if (!response.ok) {\n          const errorText = await response.text()\n          throw new Error(`Error ${response.status}: ${errorText}`)\n        }\n\n        const result = await response.json()\n\n        if (!result.success) {\n          throw new Error(result.message || 'Error en el servidor')\n        }\n\n        console.log('‚úÖ Respuesta del backend:', result)\n        return result\n\n      } catch (error) {\n        console.error('‚ùå Error en comunicaci√≥n con backend:', error)\n        throw new Error('No se pudo conectar con el servidor. Por favor intenta m√°s tarde.')\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.modal-fade-enter-active,\n.modal-fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.modal-fade-enter-from,\n.modal-fade-leave-to {\n  opacity: 0;\n}\n\n/* Animaci√≥n personalizada para el modal de √©xito */\n.success-modal-enter-active {\n  transition: all 0.5s ease;\n}\n\n.success-modal-leave-active {\n  transition: all 0.3s ease;\n}\n\n.success-modal-enter-from {\n  opacity: 0;\n  transform: scale(0.8) translateY(-20px);\n}\n\n.success-modal-leave-to {\n  opacity: 0;\n  transform: scale(0.9);\n}\n\n/* Estilos para el input de cantidad */\ninput[type=\"number\"]::-webkit-outer-spin-button,\ninput[type=\"number\"]::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=\"number\"] {\n  -moz-appearance: textfield;\n}\n</style>"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAwqBA,OAAOA,SAAQ,MAAO,yBAAwB;AAE9C,eAAe;EACbC,IAAI,EAAE,UAAU;EAChBC,UAAU,EAAE;IACVF;EACF,CAAC;EACDG,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,SAAS,EAAE,EAAE;MACbC,SAAS,EAAE,CAAC;MACZC,gBAAgB,EAAE,KAAK;MACvBC,gBAAgB,EAAE,KAAK;MACvBC,kBAAkB,EAAE,KAAK;MACzBC,yBAAyB,EAAE,KAAK;MAChCC,YAAY,EAAE,KAAK;MACnBC,YAAY,EAAE;QACZV,IAAI,EAAE,EAAE;QACRW,KAAK,EAAE,EAAE;QACTC,KAAK,EAAE;MACT,CAAC;MACDC,UAAU,EAAE;IACd;EACF,CAAC;EACDC,QAAQ,EAAE;IACRC,cAAcA,CAAA,EAAG;MACf,OAAO,IAAI,CAACL,YAAY,CAACV,IAAI,CAACgB,IAAI,CAAC,MAAM,EAAC,IACnC,IAAI,CAACN,YAAY,CAACC,KAAK,CAACK,IAAI,CAAC,MAAM,EAAC,IACpC,IAAI,CAACb,SAAS,CAACc,MAAK,GAAI,KACxB,CAAC,IAAI,CAACR,YAAW;IAC1B,CAAC;IACDS,UAAUA,CAAA,EAAG;MACX,OAAO,IAAI,CAACf,SAAS,CAACgB,MAAM,CAAC,CAACC,KAAK,EAAEC,IAAI,KAAKD,KAAI,IAAKC,IAAI,CAACC,QAAO,IAAK,CAAC,CAAC,EAAE,CAAC;IAC/E,CAAC;IACDC,WAAWA,CAAA,EAAG;MACZ,OAAO,IAAI,CAACpB,SAAS,CAACgB,MAAM,CAAC,CAACC,KAAK,EAAEC,IAAI,KAAKD,KAAI,IAAKC,IAAI,CAACG,SAAQ,IAAK,CAAC,CAAC,EAAE,CAAC;IAChF,CAAC;IACDC,kBAAkBA,CAAA,EAAG;MACnB,MAAMC,KAAI,GAAI,IAAI,CAACvB,SAAS,CAACwB,GAAG,CAACN,IAAG,IAAKA,IAAI,CAACO,WAAW,CAAC,CAACC,MAAM,CAACC,OAAO,CAAC;MAC1E,OAAO,CAAC,GAAG,IAAIC,GAAG,CAACL,KAAK,CAAC,CAAC;IAC5B;EACF,CAAC;EACDM,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,QAAQ,CAAC;EAChB,CAAC;EACDC,OAAO,EAAE;IACP;IACAC,QAAQA,CAACC,QAAQ,EAAE;MACjB,OAAOA,QAAO,IAAKA,QAAQ,CAACC,UAAU,CAAC,QAAQ;IACjD,CAAC;IAED;IACAC,cAAcA,CAACC,KAAK,EAAE;MACpB,IAAI,CAACA,KAAK,EAAE,OAAO,KAAI;MACvB,IAAIA,KAAI,KAAM,CAAC,EAAE,OAAO,SAAQ;MAChC,MAAMC,CAAA,GAAI,IAAG;MACb,MAAMC,KAAI,GAAI,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;MACxC,MAAMC,CAAA,GAAIC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,GAAG,CAACN,KAAK,IAAII,IAAI,CAACE,GAAG,CAACL,CAAC,CAAC;MAClD,OAAOM,UAAU,CAAC,CAACP,KAAI,GAAII,IAAI,CAACI,GAAG,CAACP,CAAC,EAAEE,CAAC,CAAC,EAAEM,OAAO,CAAC,CAAC,CAAC,IAAI,GAAE,GAAIP,KAAK,CAACC,CAAC;IACxE,CAAC;IAEDT,QAAQA,CAAA,EAAG;MACT,MAAMgB,SAAQ,GAAIC,YAAY,CAACC,OAAO,CAAC,iBAAiB;MACxD,IAAIF,SAAS,EAAE;QACb,IAAI;UACF,MAAMG,QAAO,GAAIC,IAAI,CAACC,KAAK,CAACL,SAAS;UACrC,IAAI,CAAC9C,SAAQ,GAAIiD,QAAQ,CAACzB,GAAG,CAACN,IAAG,KAAM;YACrC,GAAGA,IAAI;YACPC,QAAQ,EAAED,IAAI,CAACC,QAAO,IAAK,CAAC;YAC5B;YACAE,SAAS,EAAEH,IAAI,CAACG,SAAQ,KAAMH,IAAI,CAACkC,KAAI,GAAIlC,IAAI,CAACkC,KAAK,CAACtC,MAAK,GAAI,CAAC,CAAC;YACjEsC,KAAK,EAAElC,IAAI,CAACkC,KAAI,KAAMlC,IAAI,CAACmC,QAAO,GAAI,CAACnC,IAAI,CAACmC,QAAQ,IAAI,EAAE;UAC5D,CAAC,CAAC;UACF,IAAI,CAACpD,SAAQ,GAAI,IAAI,CAACD,SAAS,CAACc,MAAK;UACrCwC,OAAO,CAACZ,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC1C,SAAS,CAACc,MAAM,EAAE,WAAW;UACrEwC,OAAO,CAACZ,GAAG,CAAC,yBAAyB,EAAE,IAAI,CAACtB,WAAW;UACvDkC,OAAO,CAACZ,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAACpB,kBAAkB;QAC5D,EAAE,OAAOiC,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,qBAAqB,EAAEA,KAAK;UAC1C,IAAI,CAACvD,SAAQ,GAAI,EAAC;UAClB,IAAI,CAACC,SAAQ,GAAI;QACnB;MACF;IACF,CAAC;IAED;IACAuD,oBAAoBA,CAACC,WAAW,EAAE;MAChC,MAAMC,QAAO,GAAI;QACfC,QAAQ,EAAE,IAAI;QACdC,IAAI,EAAE,IAAI;QACVC,KAAK,EAAE,IAAI;QACXC,KAAK,EAAE,IAAI;QACXC,IAAI,EAAE,IAAI;QACVC,MAAM,EAAE,IAAI;QACZC,KAAK,EAAE;MACT,CAAC;MACD,OAAOP,QAAQ,CAACD,WAAW,KAAK,IAAI;IACtC,CAAC;IAED;IACAS,gBAAgBA,CAACC,MAAM,EAAE;MACvB,MAAMjD,IAAG,GAAI,IAAI,CAAClB,SAAS,CAACoE,IAAI,CAAClD,IAAG,IAAKA,IAAI,CAACmD,EAAC,KAAMF,MAAM;MAC3D,IAAIjD,IAAI,EAAE;QACRA,IAAI,CAACC,QAAO,GAAI,CAACD,IAAI,CAACC,QAAO,IAAK,CAAC,IAAI;QACvC,IAAI,CAACmD,QAAQ,CAAC;MAChB;IACF,CAAC;IAEDC,gBAAgBA,CAACJ,MAAM,EAAE;MACvB,MAAMjD,IAAG,GAAI,IAAI,CAAClB,SAAS,CAACoE,IAAI,CAAClD,IAAG,IAAKA,IAAI,CAACmD,EAAC,KAAMF,MAAM;MAC3D,IAAIjD,IAAG,IAAKA,IAAI,CAACC,QAAO,GAAI,CAAC,EAAE;QAC7BD,IAAI,CAACC,QAAO,IAAK;QACjB,IAAI,CAACmD,QAAQ,CAAC;MAChB;IACF,CAAC;IAEDE,gBAAgBA,CAACtD,IAAI,EAAE;MACrB,IAAI,CAACA,IAAI,CAACC,QAAO,IAAKD,IAAI,CAACC,QAAO,GAAI,CAAC,EAAE;QACvCD,IAAI,CAACC,QAAO,GAAI;MAClB;MACA,IAAID,IAAI,CAACC,QAAO,GAAI,GAAG,EAAE;QACvBD,IAAI,CAACC,QAAO,GAAI,GAAE;MACpB;MACA,IAAI,CAACmD,QAAQ,CAAC;IAChB,CAAC;IAEDG,cAAcA,CAAChB,WAAW,EAAE;MAC1B,MAAMiB,KAAI,GAAI;QACZf,QAAQ,EAAE,WAAW;QACrBC,IAAI,EAAE,QAAQ;QACdC,KAAK,EAAE,cAAc;QACrBC,KAAK,EAAE,iBAAiB;QACxBC,IAAI,EAAE,QAAQ;QACdC,MAAM,EAAE,gBAAgB;QACxBC,KAAK,EAAE;MACT;MACA,OAAOS,KAAK,CAACjB,WAAW,KAAK,UAAS;IACxC,CAAC;IAEDkB,mBAAmBA,CAAClB,WAAW,EAAE;MAC/B,MAAMmB,MAAK,GAAI;QACbjB,QAAQ,EAAE,UAAU;QACpBC,IAAI,EAAE,MAAM;QACZC,KAAK,EAAE,OAAO;QACdC,KAAK,EAAE,OAAO;QACdC,IAAI,EAAE,cAAc;QACpBC,MAAM,EAAE,QAAQ;QAChBC,KAAK,EAAE;MACT;MACA,OAAOW,MAAM,CAACnB,WAAW,KAAK,UAAS;IACzC,CAAC;IAEDoB,UAAUA,CAACC,UAAU,EAAE;MACrB,IAAI,CAACA,UAAU,EAAE,OAAO,qBAAoB;MAC5C,IAAI;QACF,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,UAAU;QAChC,OAAOC,IAAI,CAACE,kBAAkB,CAAC,OAAO,EAAE;UACtCC,GAAG,EAAE,SAAS;UACdC,KAAK,EAAE,SAAS;UAChBC,IAAI,EAAE;QACR,CAAC;MACH,EAAE,OAAO7B,KAAK,EAAE;QACd,OAAO,gBAAe;MACxB;IACF,CAAC;IAED8B,UAAUA,CAAClB,MAAM,EAAE;MACjB,IAAI,CAACnE,SAAQ,GAAI,IAAI,CAACA,SAAS,CAAC0B,MAAM,CAACR,IAAG,IAAKA,IAAI,CAACmD,EAAC,KAAMF,MAAM;MACjE,IAAI,CAACG,QAAQ,CAAC;MACd,IAAI,CAACrE,SAAQ,GAAI,IAAI,CAACD,SAAS,CAACc,MAAK;IACvC,CAAC;IAEDwE,SAASA,CAAA,EAAG;MACV,IAAI,IAAI,CAACtF,SAAS,CAACc,MAAK,KAAM,CAAC,EAAE;QAC/BwC,OAAO,CAACZ,GAAG,CAAC,0BAA0B;QACtC;MACF;MACA,IAAI,CAACtC,kBAAiB,GAAI,IAAG;IAC/B,CAAC;IAEDmF,gBAAgBA,CAAA,EAAG;MACjB,IAAI,CAACvF,SAAQ,GAAI,EAAC;MAClB,IAAI,CAACsE,QAAQ,CAAC;MACd,IAAI,CAACrE,SAAQ,GAAI;MACjB,IAAI,CAACG,kBAAiB,GAAI,KAAI;IAChC,CAAC;IAED;IACAoF,uBAAuBA,CAAA,EAAG;MACxB,IAAI,CAACrF,gBAAe,GAAI,KAAI;MAC5B;MACAsF,UAAU,CAAC,MAAM;QACf,IAAI,CAACpF,yBAAwB,GAAI,IAAG;MACtC,CAAC,EAAE,GAAG;IACR,CAAC;IAEDqF,aAAaA,CAAA,EAAG;MACd;MACA,IAAI,CAACrF,yBAAwB,GAAI,KAAI;MACrCiD,OAAO,CAACZ,GAAG,CAAC,yBAAyB,EAAE,IAAI,CAAC3B,UAAU,EAAE,WAAW;IACrE,CAAC;IAED4E,qBAAqBA,CAAA,EAAG;MACtB;MACA,IAAI,CAAC3F,SAAQ,GAAI,EAAC;MAClB,IAAI,CAACsE,QAAQ,CAAC;MACd,IAAI,CAACrE,SAAQ,GAAI;MACjB,IAAI,CAACI,yBAAwB,GAAI,KAAI;MACrCiD,OAAO,CAACZ,GAAG,CAAC,+CAA+C;IAC7D,CAAC;IAED,MAAM4B,QAAQA,CAAA,EAAG;MACf,IAAI;QACF,MAAMsB,UAAS,GAAI,IAAI,CAAC5F,SAAS,CAACwB,GAAG,CAACN,IAAG,KAAM;UAC7CmD,EAAE,EAAEnD,IAAI,CAACmD,EAAE;UACXZ,WAAW,EAAEvC,IAAI,CAACuC,WAAW;UAC7BoC,WAAW,EAAE3E,IAAI,CAAC2E,WAAW;UAC7BpE,WAAW,EAAEP,IAAI,CAACO,WAAW;UAC7BqE,SAAS,EAAE5E,IAAI,CAAC4E,SAAS;UACzB1C,KAAK,EAAElC,IAAI,CAACkC,KAAK;UACjB/B,SAAS,EAAEH,IAAI,CAACG,SAAS;UACzB0E,KAAK,EAAE7E,IAAI,CAAC6E,KAAK;UACjBhB,IAAI,EAAE7D,IAAI,CAAC6D,IAAI;UACf5D,QAAQ,EAAED,IAAI,CAACC,QAAO,IAAK;QAC7B,CAAC,CAAC;QACF4B,YAAY,CAACiD,OAAO,CAAC,iBAAiB,EAAE9C,IAAI,CAAC+C,SAAS,CAACL,UAAU,CAAC;MACpE,EAAE,OAAOrC,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,oBAAoB,EAAEA,KAAK;MAC3C;IACF,CAAC;IAED;IACA,MAAM2C,gBAAgBA,CAAA,EAAG;MACvB,IAAI,CAAC,IAAI,CAACtF,cAAc,EAAE;QACxBuF,KAAK,CAAC,+CAA+C;QACrD;MACF;MAEA,IAAI,CAAC7F,YAAW,GAAI,IAAG;MAEvB,IAAI;QACF;QACA,MAAM8F,SAAQ,GAAI;UAChBC,YAAY,EAAE,IAAI,CAAC9F,YAAY,CAACV,IAAI;UACpCyG,aAAa,EAAE,IAAI,CAAC/F,YAAY,CAACC,KAAK;UACtC+F,aAAa,EAAE,IAAI,CAAChG,YAAY,CAACE,KAAI,IAAK,kBAAkB;UAC5D+F,YAAY,EAAE,IAAI,CAACC,kBAAkB,CAAC,CAAC;UACvCrD,KAAK,EAAE,MAAM,IAAI,CAACsD,gBAAgB,CAAC;QACrC;QAEApD,OAAO,CAACZ,GAAG,CAAC,kCAAkC,EAAE;UAC9CiE,QAAQ,EAAEP,SAAS,CAACC,YAAY;UAChCO,SAAS,EAAE,IAAI,CAAC7F,UAAU;UAC1B8F,QAAQ,EAAET,SAAS,CAAChD,KAAK,CAACtC,MAAM;UAChCgG,OAAO,EAAE,IAAI,CAACxF,kBAAkB,CAACR;QACnC,CAAC;;QAED;QACA,MAAM,IAAI,CAACiG,aAAa,CAACX,SAAS;;QAElC;QACA,IAAI,CAACjG,gBAAe,GAAI,IAAG;QAC3B,IAAI,CAACD,gBAAe,GAAI,KAAI;;QAE5B;QACA,IAAI,CAACK,YAAW,GAAI;UAClBV,IAAI,EAAE,EAAE;UACRW,KAAK,EAAE,EAAE;UACTC,KAAK,EAAE;QACT;MAEF,EAAE,OAAO8C,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEA,KAAK;QAC/C4C,KAAK,CAAC,+BAA8B,GAAI5C,KAAK,CAACyD,OAAO;MACvD,UAAU;QACR,IAAI,CAAC1G,YAAW,GAAI,KAAI;MAC1B;IACF,CAAC;IAED;IACAmG,kBAAkBA,CAAA,EAAG;MACnB,MAAMQ,WAAU,GAAI,IAAIjC,IAAI,CAAC,CAAC,CAACC,kBAAkB,CAAC,OAAO,EAAE;QACzDiC,OAAO,EAAE,MAAM;QACf9B,IAAI,EAAE,SAAS;QACfD,KAAK,EAAE,MAAM;QACbD,GAAG,EAAE,SAAS;QACdiC,IAAI,EAAE,SAAS;QACfC,MAAM,EAAE;MACV,CAAC;MAED,IAAIC,OAAM,GAAI,6BAA4B;MAC1CA,OAAM,IAAK,UAAUJ,WAAW,MAAK;;MAErC;MACAI,OAAM,IAAK,8BAA6B;MACxCA,OAAM,IAAK,aAAa,IAAI,CAAC9G,YAAY,CAACV,IAAI,IAAG;MACjDwH,OAAM,IAAK,eAAe,IAAI,CAAC9G,YAAY,CAACC,KAAK,IAAG;MACpD6G,OAAM,IAAK,YAAY,IAAI,CAAC9G,YAAY,CAACE,KAAI,IAAK,kBAAkB,MAAK;;MAEzE;MACA4G,OAAM,IAAK,yBAAwB;MACnCA,OAAM,IAAK,yBAAyB,IAAI,CAACtG,UAAU,IAAG;MACtDsG,OAAM,IAAK,wBAAwB,IAAI,CAACjG,WAAW,IAAG;MACtDiG,OAAM,IAAK,qBAAqB,IAAI,CAAC/F,kBAAkB,CAACR,MAAM,IAAG;MACjEuG,OAAM,IAAK,cAAc,IAAI,CAAC/F,kBAAkB,CAACgG,IAAI,CAAC,IAAI,CAAC,MAAK;;MAEhE;MACAD,OAAM,IAAK,8BAA6B;MAExC,IAAI,CAACrH,SAAS,CAACuH,OAAO,CAAC,CAACrG,IAAI,EAAEsG,KAAK,KAAK;QACtC,MAAMrG,QAAO,GAAID,IAAI,CAACC,QAAO,IAAK;QAClCkG,OAAM,IAAK,YAAYG,KAAI,GAAI,CAAC,cAActG,IAAI,CAACO,WAAU,IAAK,KAAK,KAAI;QAC3E4F,OAAM,IAAK,WAAW,IAAI,CAAC1C,mBAAmB,CAACzD,IAAI,CAACuC,WAAW,CAAC,IAAG;QACnE4D,OAAM,IAAK,aAAanG,IAAI,CAAC2E,WAAW,IAAG;QAC3CwB,OAAM,IAAK,eAAelG,QAAQ,IAAIA,QAAO,KAAM,IAAI,QAAO,GAAI,UAAU,IAAG;QAC/EkG,OAAM,IAAK,aAAanG,IAAI,CAAC4E,SAAQ,GAAI,mBAAkB,GAAI,mBAAmB,IAAG;QAErF,IAAI5E,IAAI,CAAC4E,SAAQ,IAAK5E,IAAI,CAACkC,KAAI,IAAKlC,IAAI,CAACkC,KAAK,CAACtC,MAAK,GAAI,CAAC,EAAE;UACzDuG,OAAM,IAAK,yBAAyBnG,IAAI,CAACG,SAAS,IAAG;UACrDH,IAAI,CAACkC,KAAK,CAACmE,OAAO,CAAC,CAACE,IAAI,EAAEC,SAAS,KAAK;YACtCL,OAAM,IAAK,cAAcK,SAAQ,GAAI,CAAC,KAAKD,IAAI,CAAC5H,IAAI,KAAK,IAAI,CAACsC,cAAc,CAACsF,IAAI,CAACE,IAAI,CAAC,KAAI;UAC7F,CAAC;QACH;QAEA,IAAIzG,IAAI,CAAC6E,KAAI,IAAK7E,IAAI,CAAC6E,KAAK,CAAClF,IAAI,CAAC,MAAM,EAAE,EAAE;UAC1CwG,OAAM,IAAK,YAAYnG,IAAI,CAAC6E,KAAK,IAAG;QACtC;QAEAsB,OAAM,IAAK,yBAAyB,IAAI,CAACxC,UAAU,CAAC3D,IAAI,CAAC6D,IAAI,CAAC,MAAK;MACrE,CAAC;MAEDsC,OAAM,IAAK,OAAM;MACjBA,OAAM,IAAK,uEAAsE;MACjFA,OAAM,IAAK,8FAA6F;MAExG,OAAOA,OAAM;IACf,CAAC;IAED;IACA,MAAMX,gBAAgBA,CAAA,EAAG;MACvB,MAAMtD,KAAI,GAAI,EAAC;MAEf,KAAK,MAAMlC,IAAG,IAAK,IAAI,CAAClB,SAAS,EAAE;QACjC,IAAIkB,IAAI,CAAC4E,SAAQ,IAAK5E,IAAI,CAACkC,KAAI,IAAKlC,IAAI,CAACkC,KAAK,CAACtC,MAAK,GAAI,CAAC,EAAE;UACzD,KAAK,MAAMuC,QAAO,IAAKnC,IAAI,CAACkC,KAAK,EAAE;YACjC,IAAI;cACF,MAAMqE,IAAG,GAAI,MAAM,IAAI,CAACG,YAAY,CAClCvE,QAAQ,CAACtD,IAAI,EACb,GAAGmB,IAAI,CAACO,WAAW,IAAI4B,QAAQ,CAACxD,IAAI,EAAE;cAAE;cACxCwD,QAAQ,CAACwE,IACX;cACAzE,KAAK,CAAC0E,IAAI,CAACL,IAAI;cACfnE,OAAO,CAACZ,GAAG,CAAC,uBAAuB+E,IAAI,CAAC5H,IAAI,kBAAkBqB,IAAI,CAACO,WAAW,EAAE;YAClF,EAAE,OAAO8B,KAAK,EAAE;cACdD,OAAO,CAACC,KAAK,CAAC,+BAA+BF,QAAQ,EAAExD,IAAI,GAAG,EAAE0D,KAAK;YACvE;UACF;QACF;MACF;MAEA,OAAOH,KAAI;IACb,CAAC;IAED;IACAwE,YAAYA,CAACG,YAAY,EAAEC,QAAQ,EAAEC,QAAQ,EAAE;MAC7C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;QACtC,IAAI;UACF;UACA,MAAMC,UAAS,GAAIN,YAAY,CAACO,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;UAE5C,IAAI,CAACD,UAAU,EAAE;YACfD,MAAM,CAAC,IAAIG,KAAK,CAAC,yBAAyB,CAAC;YAC3C;UACF;;UAEA;UACA,MAAMC,cAAa,GAAIC,IAAI,CAACJ,UAAU;UACtC,MAAMK,UAAS,GAAI,EAAC;UAEpB,KAAK,IAAIC,MAAK,GAAI,CAAC,EAAEA,MAAK,GAAIH,cAAc,CAAC1H,MAAM,EAAE6H,MAAK,IAAK,IAAI,EAAE;YACnE,MAAMC,KAAI,GAAIJ,cAAc,CAACI,KAAK,CAACD,MAAM,EAAEA,MAAK,GAAI,IAAI;YACxD,MAAME,WAAU,GAAI,IAAIC,KAAK,CAACF,KAAK,CAAC9H,MAAM;YAE1C,KAAK,IAAIyB,CAAA,GAAI,CAAC,EAAEA,CAAA,GAAIqG,KAAK,CAAC9H,MAAM,EAAEyB,CAAC,EAAE,EAAE;cACrCsG,WAAW,CAACtG,CAAC,IAAIqG,KAAK,CAACG,UAAU,CAACxG,CAAC;YACrC;YAEA,MAAMyG,SAAQ,GAAI,IAAIC,UAAU,CAACJ,WAAW;YAC5CH,UAAU,CAACZ,IAAI,CAACkB,SAAS;UAC3B;UAEA,MAAME,IAAG,GAAI,IAAIC,IAAI,CAACT,UAAU,EAAE;YAAEb,IAAI,EAAEI;UAAS,CAAC;UACpD,MAAMR,IAAG,GAAI,IAAI2B,IAAI,CAAC,CAACF,IAAI,CAAC,EAAElB,QAAQ,EAAE;YAAEH,IAAI,EAAEI,QAAQ;YAAEoB,YAAY,EAAErE,IAAI,CAACsE,GAAG,CAAC;UAAE,CAAC;UAEpFnB,OAAO,CAACV,IAAI;QACd,EAAE,OAAOlE,KAAK,EAAE;UACd6E,MAAM,CAAC7E,KAAK;QACd;MACF,CAAC;IACH,CAAC;IAED;IACA,MAAMwD,aAAaA,CAACX,SAAS,EAAE;MAC7B,IAAI;QACF,MAAMmD,QAAO,GAAI,IAAIC,QAAQ,CAAC;;QAE9B;QACAD,QAAQ,CAACE,MAAM,CAAC,cAAc,EAAErD,SAAS,CAACC,YAAY;QACtDkD,QAAQ,CAACE,MAAM,CAAC,eAAe,EAAErD,SAAS,CAACE,aAAa;QACxDiD,QAAQ,CAACE,MAAM,CAAC,eAAe,EAAErD,SAAS,CAACG,aAAa;QACxDgD,QAAQ,CAACE,MAAM,CAAC,cAAc,EAAErD,SAAS,CAACI,YAAY;;QAEtD;QACA,IAAIJ,SAAS,CAAChD,KAAI,IAAKgD,SAAS,CAAChD,KAAK,CAACtC,MAAK,GAAI,CAAC,EAAE;UACjDsF,SAAS,CAAChD,KAAK,CAACmE,OAAO,CAAC,CAACE,IAAI,EAAED,KAAK,KAAK;YACvC,IAAIC,IAAG,IAAKA,IAAG,YAAa2B,IAAI,EAAE;cAChCG,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEhC,IAAI,EAAEA,IAAI,CAAC5H,IAAI;cACxCyD,OAAO,CAACZ,GAAG,CAAC,sBAAsB8E,KAAI,GAAI,CAAC,GAAG,EAAEC,IAAI,CAAC5H,IAAI;YAC3D;UACF,CAAC;QACH;QAEAyD,OAAO,CAACZ,GAAG,CAAC,0BAA0B0D,SAAS,CAAChD,KAAK,CAACtC,MAAM,cAAc;;QAE1E;QACA,MAAM4I,QAAO,GAAI,MAAMC,KAAK,CAAC,GAAG,IAAI,CAACjJ,UAAU,iBAAiB,EAAE;UAChEkJ,MAAM,EAAE,MAAM;UACdC,IAAI,EAAEN;QACR,CAAC;QAED,IAAI,CAACG,QAAQ,CAACI,EAAE,EAAE;UAChB,MAAMC,SAAQ,GAAI,MAAML,QAAQ,CAACM,IAAI,CAAC;UACtC,MAAM,IAAIzB,KAAK,CAAC,SAASmB,QAAQ,CAACO,MAAM,KAAKF,SAAS,EAAE;QAC1D;QAEA,MAAMG,MAAK,GAAI,MAAMR,QAAQ,CAACS,IAAI,CAAC;QAEnC,IAAI,CAACD,MAAM,CAACE,OAAO,EAAE;UACnB,MAAM,IAAI7B,KAAK,CAAC2B,MAAM,CAAClD,OAAM,IAAK,sBAAsB;QAC1D;QAEA1D,OAAO,CAACZ,GAAG,CAAC,0BAA0B,EAAEwH,MAAM;QAC9C,OAAOA,MAAK;MAEd,EAAE,OAAO3G,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,sCAAsC,EAAEA,KAAK;QAC3D,MAAM,IAAIgF,KAAK,CAAC,mEAAmE;MACrF;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}